% Very simple template for lab reports. Most common packages are already included.
\documentclass[a4paper, 12pt]{article}
\usepackage[utf8]{inputenc} % Change according your file encoding
\usepackage{graphicx}
%\usepackage{float}
%\usepackage{url}

%opening
\title{Motion Capturement Project Paper}
\author{Steven Arnow, Axel Isaksson, Markus Renström\\stevena@kth.se, axelis@kth.se, markusre@kth.se}

\date{\today{}}

\begin{document}
\pagenumbering{gobble}
\maketitle



%1. A description of the system and application you have decided to implement.  Be sure to explain why the application is useful, and how it uses sensors. Förklaras i Introduktion, Application och sensors, samma frågor som draften till proj.

%2. A complete description of the software and hardware architecture you have used to implement your project.  This description should have block diagrams of your system, hardware schematics, software flowcharts and listings, and other information about how you implemented your system and application.

%3. Data that shows how your design performs.

%4. [SHOULD BE DONE INVIDUALLY]! Conclusions about your design.  Interpret your data and describe how well the application works.  Explain performance, especially in terms of power consumption, and estimate of cost.  Critique your design.  Do you think people would buy it?  How much money might they spend to buy it?  How would you improve your design?  What would you do differently if you were to re-design it?  Be as detailed and thoughtful as you can on these points.

\section*{Introduction}
This report covers the results of a project in the course Sensor based system (II2302) at KTH during the fall of 2015\cite{kursp}. The project was to create a sensor based motion capturement system which relied on gyroscopes and accelerometers to capture and track movements of an object. The goal was to be able to record motions and capture the movements of i.e. limbs, simple objects or small animals.
%%Fyll på?

%%%%%%%%%%%%%%%%%%%%%
\subsection*{The application}
A motion capturement system \cite{wiki} can be used in many applications where real world motions and movements is studied or analysed. The most common usage for a motion capturement system is digital animation in video games and movies where characters movement is based on movements taken from a motion capturement system. The application can also be used in physics, medical implementation and sports to collect data for further analysis.

The technique behind motion capturement and recording motion have only been used for around a decade. Since the technique is rather new there's still much potential for finding new implementations in the field.
 
%%Fyll på?

    
%Applications for a motion capturement system is   we want to develop during this project is a motion capture system  that will be able to see and record movements. The idea is to develop some smaller modules which records accelerations as well as orientation and then by combining their data information about the motion can be created.

  
%%%%%%%%%%%%%%%%%%%%%
\subsection*{Sensors}
The system created in this project used mostly accelerometers and gyroscopes.  small   would most likely depend on sensors such as accelerometers and gyroscopes to capture the actual motions. The project would probably also need some sort of wireless module with radio sensors to be able to "lift out" heavier computations and avoid wires (with can prevent mobility). 

The smaller modules will therefore be connected to a larger module which will transmit the collect the data wirelessly to a computer. This will have the benefits of avoiding limitation by cables and such. 


\section*{Design}
In this part of the report all the hardware and software constructed during this project will be presented and explained. The architectures of the implementations will be shown in flow charts, block diagram, schematics to illustrate how the system is functioning.  

%%%%%%%%%%%%%%%%%%%%%
\subsection*{Block diagram}
Below is a simple block diagram presented which shows the main design of the project (see Figure ~\ref{fig:pic2}). The picture also gives a quick indication of which kinds of parts the implementation will need. The figure also shows that the hardware can be divided into three different parts depending on their functionallity and objectives, the parts are IMUs, motherboard and the host computer.     
 
\begin{figure}[h!]
    \centering
    \includegraphics[scale=0.38]{block.pdf}
    \caption{A block diagram showing the most vital parts of the project, note that the different part is physically separeted.}
    \label{fig:pic2}
\end{figure}

\newpage
\subsection*{Flow charts}
The software of this project can be described by two flow charts, one representing the implementation on the motherboard and the other representing the host computer. Figure~\ref{fig:pic3} shows how the motherboard application works in a comprehensive maner. 


\begin{figure}[h!]
    \centering
    \includegraphics[scale=0.38]{micro.eps}
    \caption{A flow chart of motherboards micro controller code}
    \label{fig:pic3}
\end{figure}

In short the program first initializes the radio link and it's communication protocol. The second step is to check and enumerate the number of IMUs that is connected to the motherboard. After initialization the soft ware enters a main loop where each IMU is sampled and the data is packed. If all samples have been taken then the data is transmitted to the host computer and the program goes back to the beginning of the loop and samples data from the IMUs again.    

 
\begin{figure}[h!] %% För att H ska funka krävs väl float packetet?
    \centering
    \includegraphics[scale=0.38]{pi.eps}
    \caption{Flow chart of host computer code}
    \label{fig:pic4}
\end{figure}

The flow chart of the host computer is a bit more advanced and consists of several steps. The application begins by initializing the radio link and the skeleton structure which creates a bone structure. After the initialization steps the program waits for data from the motherboard and when it is recieved the gyros are calibrated with regards of the gravity vector. The program then recalculates the bones with the gravity data and enters a loop which handles the core functions.
[HÄR SKA MER IN]
%HÄR SKA MER IN

\subsection*{Schematics} % Ska vi ha med ngt om ritningarna till svarvade kretskort?
The hard ware schematics of the system describes how it was constructed and the different components used. To make the system more reliable, robust and efficient the components where mounted on printed circuit boards designed during the course. Figure~\ref{fig:pic5} shows the schematics for the motherboard.
 

\begin{figure}[h!] %% Behöver nog kanske krympas lite 
    \centering
    \includegraphics[scale=0.67]{mb_schematic.pdf}
    \caption{The Motherboard schematic}
    \label{fig:pic5}
\end{figure}

\noindent %lat
The connectors \textit{IMU 0} to \textit{IMU 5} on the motherboard (see Figure~\ref{fig:pic5}) will be connected to the \textit{CONN\_IN} connector on the different IMUs in the system. The IMU design are described by the schematics in Figure~\ref{fig:pic6} below. Note that the IMUs were constructed in a relativly small format which improved mobility but caused difficulties during the construction phase. % sista kanske lite överflödigt   
 
\begin{figure}[h!]%% För att H ska funka krävs väl float packetet?
    \centering
    \includegraphics{imu_schematic.pdf}
    \caption{IMU board schematic}
    \label{fig:pic6}
\end{figure}


\section*{Data and Performance}
In this section of the report all the data and results of the project will be presented and evaluated. The measurements made have been focusing on capturing the system's drift over time and ability to correctly detect angles, both in high and low speed.

To collect data samples the system was installed in a simple laboration setup where angles could be read from the motion capturement system and a protractor. By reading values from a camera time could also be captured and measurements could be done in high speed. 

The setup was constructed by office-material found in the sourroundings to the project (see Figure~\ref{fig:pic7}), a folder was just as a hinge/joint and was stabilized by several books. A protractor was taped in line with the joint and made it possible to read angles manually. 

\begin{figure}[h!]
    \centering
    \includegraphics[scale=0.27]{croped.jpg}
    \caption{The laboration setup during data sampling for angles, note that the computer displays data values visible from the camera}
    \label{fig:pic7}
\end{figure}

To collect drift data of the system it was mounted on a table (which wasn't used) and then left to run for some time.  

\begin{figure}[h!]
    \centering
    \includegraphics[scale=1.15]{drift.pdf}
    \caption{Stationary IMU drift over time}
    \label{fig:pic8}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[scale=1.15]{stepped.pdf}
    \caption{Slow, stepped angle bend}
    \label{fig:pic8}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[scale=1.15]{fast_continuous.pdf}
    \caption{Fast, continuous bend}
    \label{fig:pic9}
\end{figure}

\section*{Individual reflection and Conclusion}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\newpage
%%\raggedright


\begin{thebibliography}{7}

\bibitem{kursp}
	The course web page,
	\textit{$https://people.kth.se/~msmith/II2302\_2016.html$}, fetched \date{\today{}}.

\bibitem{wiki}
	Motion Capture on Wikipedia,
	\textit{$www.en.wikipedia.org/wiki/Motion\_capture$}, fetched \date{\today{}}.


	


\end{thebibliography}
\end{document}

